{"version":3,"sources":["../../../../src/components/dialog/messages/Reactions.react.js"],"names":["MessageReactions","props","handleAddLike","addLike","peer","message","rid","setState","isThisMyReaction","handleRemoveLike","removeLike","state","canAnimateHeart","componentWillReceiveProps","render","hasReactions","reactions","length","counter","icon","reactionsClassName","likers","amILikeThat","isOwnSet","uids","map","getUser","uid","user","nick","name","id","join","propTypes","object","isRequired"],"mappings":"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","file":"Reactions.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport classnames from 'classnames';\nimport CSSTransitionGroup from 'react-addons-css-transition-group';\nimport MessageActionCreators from '../../../actions/MessageActionCreators';\n\nimport Tooltip from 'rc-tooltip';\nimport ActorClient from '../../../utils/ActorClient';\n\nclass MessageReactions extends Component {\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    message: PropTypes.object.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      canAnimateHeart: true\n    };\n  }\n\n  componentWillReceiveProps() {\n    if (this.state.isThisMyReaction) {\n      this.setState({\n        canAnimateHeart: false,\n        isThisMyReaction: false\n      })\n    } else {\n      this.setState({ canAnimateHeart: true })\n    }\n  }\n\n  handleAddLike = () => {\n    MessageActionCreators.addLike(this.props.peer, this.props.message.rid);\n    this.setState({ isThisMyReaction: true })\n  };\n  handleRemoveLike = () => {\n    MessageActionCreators.removeLike(this.props.peer, this.props.message.rid);\n    this.setState({ isThisMyReaction: true })\n  };\n\n  render() {\n    const { message } = this.props;\n    const { canAnimateHeart } = this.state;\n    const hasReactions = message.reactions.length > 0;\n\n    let counter;\n    let icon = <i className=\"icon icon-favorite material-icons\" onClick={this.handleAddLike}></i>;\n    let reactionsClassName = 'message__actions__like';\n    let likers = '(nobody)';\n\n    if (hasReactions) {\n      const amILikeThat = message.reactions[0].isOwnSet;\n\n      reactionsClassName = classnames(reactionsClassName, {\n        'message__actions__like--has-reactions': hasReactions,\n        'message__actions__like--liked': amILikeThat,\n        'message__actions__like--with-animations': canAnimateHeart\n      });\n\n      if (amILikeThat) {\n        icon = <i className=\"icon icon-favorite material-icons\" onClick={this.handleRemoveLike}></i>\n      }\n\n      if (message.reactions[0].uids.length > 0) {\n        likers = message.reactions[0].uids.map(uid => ActorClient.getUser(uid)).map(user => user.nick || user.name || user.id).join(\", \")\n        counter = <span className=\"counter\" key={1}>{message.reactions[0].uids.length}</span>;\n      } else {\n        counter = null\n      }\n    }\n\n    return (\n      <div className={reactionsClassName}>\n        <Tooltip\n          placement=\"left\"\n          mouseEnterDelay={0}\n          mouseLeaveDelay={0}\n          overlay={`Liked by: ${likers}`}>\n          <div>\n            <CSSTransitionGroup transitionName=\"counter\" transitionEnterTimeout={125} transitionLeaveTimeout={100}>\n              {counter}\n            </CSSTransitionGroup>\n            {icon}\n          </div>\n        </Tooltip>\n      </div>\n    )\n  }\n}\n\nexport default MessageReactions;\n"]}